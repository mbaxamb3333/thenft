{"ast":null,"code":"'use strict';\n\nconst axios = require('axios');\n\nconst pkg = require('../../package.json');\n\nconst {\n  helpers: {\n    mergeData\n  },\n  classes: {\n    Response,\n    ResponseError\n  }\n} = require('@sendgrid/helpers');\n\nconst API_KEY_PREFIX = 'SG.';\nconst SENDGRID_BASE_URL = 'https://api.sendgrid.com/';\nconst TWILIO_BASE_URL = 'https://email.twilio.com/';\n\nclass Client {\n  constructor() {\n    this.auth = '';\n    this.impersonateSubuser = '';\n    this.defaultHeaders = {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      'User-Agent': 'sendgrid/' + pkg.version + ';nodejs'\n    };\n    this.defaultRequest = {\n      baseUrl: SENDGRID_BASE_URL,\n      url: '',\n      method: 'GET',\n      headers: {},\n      maxContentLength: Infinity,\n      // Don't limit the content length.\n      maxBodyLength: Infinity\n    };\n  }\n\n  setApiKey(apiKey) {\n    this.auth = 'Bearer ' + apiKey;\n    this.setDefaultRequest('baseUrl', SENDGRID_BASE_URL);\n\n    if (!this.isValidApiKey(apiKey)) {\n      console.warn(`API key does not start with \"${API_KEY_PREFIX}\".`);\n    }\n  }\n\n  setTwilioEmailAuth(username, password) {\n    const b64Auth = Buffer.from(username + ':' + password).toString('base64');\n    this.auth = 'Basic ' + b64Auth;\n    this.setDefaultRequest('baseUrl', TWILIO_BASE_URL);\n\n    if (!this.isValidTwilioAuth(username, password)) {\n      console.warn('Twilio Email credentials must be non-empty strings.');\n    }\n  }\n\n  isValidApiKey(apiKey) {\n    return this.isString(apiKey) && apiKey.trim().startsWith(API_KEY_PREFIX);\n  }\n\n  isValidTwilioAuth(username, password) {\n    return this.isString(username) && username && this.isString(password) && password;\n  }\n\n  isString(value) {\n    return typeof value === 'string' || value instanceof String;\n  }\n\n  setImpersonateSubuser(subuser) {\n    this.impersonateSubuser = subuser;\n  }\n\n  setDefaultHeader(key, value) {\n    if (key !== null && typeof key === 'object') {\n      // key is an object\n      Object.assign(this.defaultHeaders, key);\n      return this;\n    }\n\n    this.defaultHeaders[key] = value;\n    return this;\n  }\n\n  setDefaultRequest(key, value) {\n    if (key !== null && typeof key === 'object') {\n      // key is an object\n      Object.assign(this.defaultRequest, key);\n      return this;\n    }\n\n    this.defaultRequest[key] = value;\n    return this;\n  }\n\n  createHeaders(data) {\n    // Merge data with default headers.\n    const headers = mergeData(this.defaultHeaders, data); // Add auth, but don't overwrite if header already set.\n\n    if (typeof headers.Authorization === 'undefined' && this.auth) {\n      headers.Authorization = this.auth;\n    }\n\n    if (this.impersonateSubuser) {\n      headers['On-Behalf-Of'] = this.impersonateSubuser;\n    }\n\n    return headers;\n  }\n\n  createRequest(data) {\n    let options = {\n      url: data.uri || data.url,\n      baseUrl: data.baseUrl,\n      method: data.method,\n      data: data.body,\n      params: data.qs,\n      headers: data.headers\n    }; // Merge data with default request.\n\n    options = mergeData(this.defaultRequest, options);\n    options.headers = this.createHeaders(options.headers);\n    options.baseURL = options.baseUrl;\n    delete options.baseUrl;\n    return options;\n  }\n\n  request(data, cb) {\n    data = this.createRequest(data);\n    const promise = new Promise((resolve, reject) => {\n      axios(data).then(response => {\n        return resolve([new Response(response.status, response.data, response.headers), response.data]);\n      }).catch(error => {\n        if (error.response) {\n          if (error.response.status >= 400) {\n            return reject(new ResponseError(error.response));\n          }\n        }\n\n        return reject(error);\n      });\n    }); // Throw an error in case a callback function was not passed.\n\n    if (cb && typeof cb !== 'function') {\n      throw new Error('Callback passed is not a function.');\n    }\n\n    if (cb) {\n      return promise.then(result => cb(null, result)).catch(error => cb(error, null));\n    }\n\n    return promise;\n  }\n\n}\n\nmodule.exports = Client;","map":{"version":3,"sources":["/Users/mihaibadea/thenft/node_modules/@sendgrid/client/src/classes/client.js"],"names":["axios","require","pkg","helpers","mergeData","classes","Response","ResponseError","API_KEY_PREFIX","SENDGRID_BASE_URL","TWILIO_BASE_URL","Client","constructor","auth","impersonateSubuser","defaultHeaders","Accept","version","defaultRequest","baseUrl","url","method","headers","maxContentLength","Infinity","maxBodyLength","setApiKey","apiKey","setDefaultRequest","isValidApiKey","console","warn","setTwilioEmailAuth","username","password","b64Auth","Buffer","from","toString","isValidTwilioAuth","isString","trim","startsWith","value","String","setImpersonateSubuser","subuser","setDefaultHeader","key","Object","assign","createHeaders","data","Authorization","createRequest","options","uri","body","params","qs","baseURL","request","cb","promise","Promise","resolve","reject","then","response","status","catch","error","Error","result","module","exports"],"mappings":"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","sourcesContent":["'use strict';\nconst axios = require('axios');\nconst pkg = require('../../package.json');\nconst {\n  helpers: {\n    mergeData,\n  },\n  classes: {\n    Response,\n    ResponseError,\n  },\n} = require('@sendgrid/helpers');\n\nconst API_KEY_PREFIX = 'SG.';\nconst SENDGRID_BASE_URL = 'https://api.sendgrid.com/';\nconst TWILIO_BASE_URL = 'https://email.twilio.com/';\n\nclass Client {\n  constructor() {\n    this.auth = '';\n    this.impersonateSubuser = '';\n\n    this.defaultHeaders = {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n      'User-Agent': 'sendgrid/' + pkg.version + ';nodejs',\n    };\n\n    this.defaultRequest = {\n      baseUrl: SENDGRID_BASE_URL,\n      url: '',\n      method: 'GET',\n      headers: {},\n      maxContentLength: Infinity, // Don't limit the content length.\n      maxBodyLength: Infinity,\n    };\n  }\n\n  setApiKey(apiKey) {\n    this.auth = 'Bearer ' + apiKey;\n    this.setDefaultRequest('baseUrl', SENDGRID_BASE_URL);\n\n    if (!this.isValidApiKey(apiKey)) {\n      console.warn(`API key does not start with \"${API_KEY_PREFIX}\".`);\n    }\n  }\n\n  setTwilioEmailAuth(username, password) {\n    const b64Auth = Buffer.from(username + ':' + password).toString('base64');\n    this.auth = 'Basic ' + b64Auth;\n    this.setDefaultRequest('baseUrl', TWILIO_BASE_URL);\n\n    if (!this.isValidTwilioAuth(username, password)) {\n      console.warn('Twilio Email credentials must be non-empty strings.');\n    }\n  }\n\n  isValidApiKey(apiKey) {\n    return this.isString(apiKey) && apiKey.trim().startsWith(API_KEY_PREFIX);\n  }\n\n  isValidTwilioAuth(username, password) {\n    return this.isString(username) && username\n      && this.isString(password) && password;\n  }\n\n  isString(value) {\n    return typeof value === 'string' || value instanceof String;\n  }\n\n  setImpersonateSubuser(subuser) {\n    this.impersonateSubuser = subuser;\n  }\n\n  setDefaultHeader(key, value) {\n    if (key !== null && typeof key === 'object') {\n      // key is an object\n      Object.assign(this.defaultHeaders, key);\n      return this;\n    }\n\n    this.defaultHeaders[key] = value;\n    return this;\n  }\n\n  setDefaultRequest(key, value) {\n    if (key !== null && typeof key === 'object') {\n      // key is an object\n      Object.assign(this.defaultRequest, key);\n      return this;\n    }\n\n    this.defaultRequest[key] = value;\n    return this;\n  }\n\n  createHeaders(data) {\n    // Merge data with default headers.\n    const headers = mergeData(this.defaultHeaders, data);\n\n    // Add auth, but don't overwrite if header already set.\n    if (typeof headers.Authorization === 'undefined' && this.auth) {\n      headers.Authorization = this.auth;\n    }\n\n    if (this.impersonateSubuser) {\n      headers['On-Behalf-Of'] = this.impersonateSubuser;\n    }\n\n    return headers;\n  }\n\n  createRequest(data) {\n    let options = {\n      url: data.uri || data.url,\n      baseUrl: data.baseUrl,\n      method: data.method,\n      data: data.body,\n      params: data.qs,\n      headers: data.headers,\n    };\n\n    // Merge data with default request.\n    options = mergeData(this.defaultRequest, options);\n    options.headers = this.createHeaders(options.headers);\n    options.baseURL = options.baseUrl;\n    delete options.baseUrl;\n\n    return options;\n  }\n\n  request(data, cb) {\n    data = this.createRequest(data);\n\n    const promise = new Promise((resolve, reject) => {\n      axios(data)\n        .then(response => {\n          return resolve([\n            new Response(response.status, response.data, response.headers),\n            response.data,\n          ]);\n        })\n        .catch(error => {\n          if (error.response) {\n            if (error.response.status >= 400) {\n              return reject(new ResponseError(error.response));\n            }\n          }\n          return reject(error);\n        });\n    });\n\n    // Throw an error in case a callback function was not passed.\n    if (cb && typeof cb !== 'function') {\n      throw new Error('Callback passed is not a function.');\n    }\n\n    if (cb) {\n      return promise\n        .then(result => cb(null, result))\n        .catch(error => cb(error, null));\n    }\n\n    return promise;\n  }\n}\n\nmodule.exports = Client;\n"]},"metadata":{},"sourceType":"script"}